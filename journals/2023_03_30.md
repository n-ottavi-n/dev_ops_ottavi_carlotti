- # Presentation monitoring
- ![cykl-devops-cycle.png](../assets/cykl-devops-cycle_1680176955760_0.png)
-
- But: Comprendre ce qui se passe dans l'application
- Prometheus-Grafana stack
- ![architecture.png](../assets/architecture_1680178871124_0.png)
	-
	-
- ## Grafana tutorial
	- Outil de dashboard, visuels
	- https://grafana.com/tutorials/grafana-fundamentals/
	- Métriques: nb de connections actives, temps de réponses,...
	-
	-
- monitoring de requetes sur localhost:8081
- ![image.png](../assets/image_1680168090472_0.png)
-
- ![image.png](../assets/image_1680163088943_0.png)
- alerting automatique
- ![image.png](../assets/image_1680166606587_0.png)
- ![image.png](../assets/image_1680166633304_0.png){:height 351, :width 623}
- ## Prometheus
- Tutorial: https://prometheus.io/docs/prometheus/latest/getting_started/
- Développé chez Soundcloud
- Largement en GO
- Outil de monitoring et d'alerte
- Collection de métriques numériques sous forme de séries temporelles (time series)
- PromQL
- modèle pull via HTTP
- ![image.png](../assets/image_1680168439171_0.png)
- ## Plus
- Designed for reliability
- Collection de données multidimensionnelles
- ## Moins
- 100% fiable mais pas 100% précis, pas assez pour facturation
- ## Prometheus Exporter
- ### Exportation de metrics d'une application
- Personnalisation des metrics de l'application
-
- Lien vers documentation:
- https://grafana.com/oss/prometheus/exporters/
- https://prometheus.io/docs/instrumenting/exporters/
-
- Tuto :
- https://acloudguru.com/hands-on-labs/collecting-application-metrics-with-prometheus
-
- ## Exemple réalisé sur application Laravel
- Resources uilisées:
- https://grafana.com/grafana/dashboards/11034-laravel-horizon/
- https://github.com/lkaemmerling/laravel-horizon-prometheus-exporter
-
- Configuration de l'application:
	- - composer require lkaemmerling/laravel-horizon-prometheus-exporter
- Configuration de prometheus:
	- - vi /opt/homebrew/etc/prometheus.yml
- ![Capture d’écran 2023-03-30 à 14.47.20.png](../assets/Capture_d’écran_2023-03-30_à_14.47.20_1680181305167_0.png)
-
- #### Résultat
- http://localhost:8000/metrics :
- ![Capture d’écran 2023-03-30 à 14.45.37.png](../assets/Capture_d’écran_2023-03-30_à_14.45.37_1680181393299_0.png)
-
- Grafana:
- ![Capture d’écran 2023-03-30 à 14.45.11.png](../assets/Capture_d’écran_2023-03-30_à_14.45.11_1680181482544_0.png)
-